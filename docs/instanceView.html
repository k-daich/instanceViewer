<!DOCTYPE html>
<html>

<head>
    <title>InstanceView</title>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <script type="text/javascript" src="js/data.js"></script>
    <link rel="stylesheet" type="text/css" href="css/movableColumn.css">
    <link rel="stylesheet" type="text/css" href="css/lightUpCross.css">
    <style>
        :root {
            --baseColor: #363636; /* this color is dynamic set by javascript */
            --baseColor_bg: #dddddd; /* this color is dynamic set by javascript */
            --rightUpColor: #e6b2c0; /* this color is dynamic set by javascript */
        }

        html {
            color: var(--baseColor);
            background: var(--baseColor_bg);
        }

        .dynamicTable {
            border-collapse: separate;
            border-spacing: 3px;
            table-layout: fixed;
            width: 100%;
        }

        /* 動的テーブルの子孫thタグのスタイル指定 */
        /* 動的テーブルの子孫tdタグのスタイル指定 */
        .dynamicTable th,
        .dynamicTable td {
            border-style: solid;
            border-radius: 3px;
            text-align: center;
        }

        /* 動的テーブルの子孫thタグのスタイル指定 */
        .dynamicTable th {
            background-color: #c79852;
            color: white;
            border: solid 1px #927141;
            padding: 3px 0;
            font-size: 1.1rem;
            /*white-space: nowrap;*/
        }

        /* No列 */
        th.no {
            width : 30px;
        }

        /* 動的テーブルの子孫trタグのスタイル指定 */
        .dynamicTable tr {
            background-color: #e4d4bc;
        }
        /* 動的テーブルの子孫trタグのスタイル指定(偶数行) */
        .dynamicTable tr:nth-of-type(2n) {
            background-color: #eaeae0;
        }

        /* 動的テーブルの子孫tdタグのスタイル指定 */
        .dynamicTable td {
            border: solid 1px #af9d85;
            padding: 2px 0;
            font-size: 0.9rem;
        }

        .icon-column {
            position: relative;
            width: 15px;
            height: 15px;
            background: #bbb;
            border-radius: 50%;
            text-align: center;
            margin: auto;
        }

        .icon-minus::before {
            position: absolute;
            top: calc(50% - 1px);
            left: 50%;
            content: '';
            display: inline-block;
            width: 60%;
            height: 10%;
            transform: translateX(-50%);
        }

        .icon-column.icon-minus::before {
            border-top: 2px solid #fff;
        }

        .icon-menu.icon-minus::before {
            border-top: 4px solid #333;
        }

        .icon-menu {
            position : fixed;
            width: 50px;
            height: 50px;
            right : 10px;
            bottom : 10px;
            background: #ccc;
            border-radius: 50%;
            text-align: center;
            margin: auto;
            border: 5px solid #333;
            z-index: 20;
        }      

        .icon-plus::after {
            position: absolute;
            top: 50%;
            left: 50%;
            content: '';
            display: inline-block;
            width: 50%;
            height: 50%;
            border-top: 4px solid #333;
            transform: translateX(-50%);
        }

        .icon-plus:after {
            top: 25%;
            left: 0;
            transform: rotate(90deg);
        }

        .menu-window {
            position : fixed;
            right :20px;
            bottom :20px;
            width : 20vh;
            height : 150px;
            background: #000;
            border-radius: 7px;
            z-index: 10;
            transition : 1.2s;
        }

        .hidden, .hidden * {
            /*display: none;*/
            opacity : 0 !important;
            height : 5px !important;
            width : 0 !important;
            font-size : 0 !important;
            transition : 1.2s !important;
        }
    </style>
    <div id="style_writtenByJavascript">
    </div>
</head>

<body>
    <main>
        <table id="dynamicTable" class="dynamicTable">
        </table>
        <div id="menu-button" class="icon-menu icon-plus icon-minus"></div>
        <div id="menu-window" class="menu-window hidden">
            <ul id="unvealColumnList">
            </ul>
        </div>
    </main>
    <script type="text/javascript">
    /* 定数定義 */
    var STORAGE_KEY_HIDDEN_COULUMNS = 'hiddenColumns';
    var STORAGE_KEY_TBL_KEYS_DISP_ORDER = 'tableKeysForDispOrder';
    var INSTANCES_INFO = INSTANCES_INFO_INTERNAL;

    // src: 外部jsのパス
    // handler: jsのロード完了後に実行する関数
    var call = function(src, handler) {
        var base = document.getElementsByTagName("script")[0];
        var obj = document.createElement("script");
        obj.async = true;
        obj.src = src;
        if (obj.addEventListener) {
            obj.onload = function() {
                handler();
            }
        } else {
            obj.onreadystatechange = function() {
                if ("loaded" == obj.readyState || "complete" == obj.readyState) {
                    obj.onreadystatechange = null;
                    handler();
                }
            }
        }
        base.parentNode.insertBefore(obj, base);
    };

    call("http:xxxxxxx/xxx.js", function() { /*ここに処理を記載*/ })
    /**
     * 指定されたキー名のローカルストレージを取得する
     * ※無い場合は空文字を返す
     */
    function getLocalStorageAsArray(storageKey) {
        var locStrgString = localStorage.getItem(storageKey);
        console.log('[getLocalStorageAsArray] ' + storageKey + ' : ' + locStrgString);
        // ローカルストレージに値が有る場合 : カンマ区切りで配列化して返す
        // ローカルストレージに値が無い場合 : 空文字で返す
        return (locStrgString) ? locStrgString.split(',') : [];
    }

    /**
     * 表示順決定用ローカルキー配列をローカルストレージより取得する
     */
    function getTableKeysForDispOrderArrayFromLocalStorage() {
        return getLocalStorageAsArray(STORAGE_KEY_HIDDEN_COULUMNS);
    }

    /**
     * 非表示カラム配列をローカルストレージより取得する
     */
    function getHiddenColumnsArrayFrmLocStrg() {
        return getLocalStorageAsArray(STORAGE_KEY_HIDDEN_COULUMNS);
    }

    /**
     * ログUtil
     */
    function logging(processName, message) {
        console.log('[' + processName + '] ' + message);
    }
    </script>
    <script type="text/javascript" src="js/constructTable.js"></script>
    <script type="text/javascript" src="js/movableColumn.js"></script>
    <script type="text/javascript" src="js/lightUpCross.js"></script>
    <script type="text/javascript" src="js/hideColumn.js"></script>
    <script type="text/javascript" src="js/menu.js"></script>
    <script type="text/javascript" src="js/menu_unvealCoulumn.js"></script>
</body>

</html>